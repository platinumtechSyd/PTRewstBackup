{"version":2,"exportedAt":"2024-08-13T00:21:53.421322+00:00","signing":{"cert":"-----BEGIN CERTIFICATE-----\nMIICazCCAfGgAwIBAgIUFJtHAR8D+ZfChHcAXHemH7s8zRowCgYIKoZIzj0EAwIwfDELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkZMMQ4wDAYDVQQHEwVUYW1wYTEOMAwGA1UEChMFUmV3c3QxEzARBgNVBAsTClJld3N0IERldnMxKzApBgNVBAMTImxvY2FsIFJld3N0IEltcG9ydC9FeHBvcnQgQ0EyIHYxLjEwHhcNMjIwNjAzMTkwMDU1WhcNMjUwNTIzMTkwMTI1WjBDMQswCQYDVQQGEwJVUzELMAkGA1UECBMCRkwxDjAMBgNVBAcTBVRhbXBhMRcwFQYDVQQDEw5sb2NhbC5yZXdzdC5pbzB2MBAGByqGSM49AgEGBSuBBAAiA2IABMcTJzyLIvX1+3545EJbFeNVjahxVq6TFQ7n/IYZs4yEMQzDWZjAyHhJPZk3Dxq/wFzesXMYJu41rhxfz7AZh15LtFGfy9V2B4X5KH7sGJWqOan0mabuF83llruTLA/NQaNtMGswDgYDVR0PAQH/BAQDAgeAMB0GA1UdDgQWBBTDePOSC6hckrg6usrK2giZv9GxpjAfBgNVHSMEGDAWgBTojdemsJqfnB19iyMxmIi3OGYw6TAZBgNVHREEEjAQgg5sb2NhbC5yZXdzdC5pbzAKBggqhkjOPQQDAgNoADBlAjEA8NsLnuGhfTPC7dB0ojWf5WmH64qFZuPFD6Q0RwGYO0D1Tn2x5+/37kW3HFcGHV0wAjBM7LSidsc7E9+fmcesnN5hM34eGMP+YWCoEeFIPPANXQKemAgUVf35iXyU64sVEC4=\n-----END CERTIFICATE-----","hash":"sha512","signature":"MGYCMQD3qlqrg8UY8zRBb4uiiL1bxknGwBYgJOoYYpAMRAoF2sCv+fqkCyJJe6JhZXo2twQCMQDQ9HqDLJDcNzcjf/bt02nTHuNYZfmK0zt6Su7n12MP5xofjoA+dgVMNgo+DBKZufk="},"objects":{"workflow_task_id:DqEgKsVAo9aib2v3AWmLZE2xiXgyyjVPyFTi2Yzik36P":{"type":"workflow_task_id","content_hash":"DYk5qaRdx2Ecp6uk6xTo5v7Eugah9Jc1apw8eCgTQG9g","hash":"3izSadkUiMSSziNqVTqRqNatdsbTW9WvHmq5PSUoDQ1o","fields":{"id":"4000c355cd6b4cecb6af899c36dccf51"}},"trigger_type:826nxZe6xtC3TiBTjRMQxo1bm33qcCjTTPQZFTwVo3P6":{"type":"trigger_type","content_hash":"HnoxQiJaD2AXzSixvrruvJbH2LA13kjSwUttGFc847xJ","hash":"H1qSSRhW6ijrPV43CkQWG4zRzZdDE7uYhvSpDQWH9JvZ","fields":{"ref":"core.Webhook"}},"workflow_task_id:H6xFYsZTd16V5YvtdhEV589pGebEq3FnbUK7YV8pVPQa":{"type":"workflow_task_id","content_hash":"KhQ6pvasXj4T19pLbzfZqCH7WdzMH18DL2b9yp5M1Fz","hash":"JAxgUwJeqbecWCTgPNFNorwgoa6n7CoE5kToutrz1sXb","fields":{"id":"2a1617b4ddfc46789e859b7492f930e9"}},"action:88YPQyRQXBauPd9DrCvCqgLKwzGy6cvUyhum1Tr1ddd3":{"type":"action","content_hash":"CdPL6KHuhM7mBvTHi4QnQbxCitnoxuRrq1BfHNnQYzKB","hash":"Arr2RCEM96WqU2EkvigszSfsW9GZHa4HJC5a1fL9qZ5g","fields":{"ref":"core.noop"}},"transition_id:7fk3DrB3RHezgBShcBnFBaKkHK2on4nSv8hoe6TUbB3A":{"type":"transition_id","content_hash":"8YoRLo2qo2P4MkYbSuCLSdfHjyvfx6b2p6iCAfB7T5hF","hash":"Atg5xV93AfCGeczPigBmSjijFUb8TbuG7WmYBov1AaAY","fields":{"id":"b4856c2f-ab71-47c1-a265-7a2afe3c4afb"}},"transition_id:A16HukKfDqQQcNq5qV3Hcd4PMmBPDZpJqksPd57vQoai":{"type":"transition_id","content_hash":"8eaGWFVsKkC89DmwwhMGuFxuP22DGPe7YPfHGDRtvdpA","hash":"8PB2oMkKs8G1X7coNbznvwywebfTiXrAVe9ghDW7UNr6","fields":{"id":"7f301c56-88ff-4e92-9a2b-187e6a4f61c3"}},"action:99LymnGHnd9HuxaqftaSrFV2ZBWr9yPCrB6vr2iVgVVe":{"type":"action","content_hash":"23N3ubJaPa6X5iBRydHACFjBkPCx3ojoiFwyDcNZB5a1","hash":"AchMyaNUwhPjK8j3wVV34tZM4hrNovi1XH4z1MkHzuFP","fields":{"ref":"microsoft_graph.graph_api_request"}},"trigger_type:A8tNf5v7oR9dAqgjGczqVYzFssgg8bay7BL7uJeXcb8":{"type":"trigger_type","content_hash":"A3qAuVRaMet6hmXzfULwNsktw3jhyuRkt8E9LAbJCP7i","hash":"BgxjTDSUcb1fzGABhpZD1tnJecbPFAVmpUa9d2SUPepJ","fields":{"ref":"core.Always Pass"}},"transition_id:AXt5zo4oZuN6Ag7Uvshfgux2oEiVP9iSukjxzZFNo157":{"type":"transition_id","content_hash":"4M74ZoP8CBkkMoKDiML2oa5qSsFsnoQUorqjPZoXvqne","hash":"9duVJH9XN3FDDxbJLoSWgtREkk7rHCAMWQVzDHSsrHSx","fields":{"id":"4c57277c-9f20-4d10-bea7-77516bb06f01"}},"transition_id:G37zscTRoJYvJC3hTvftQesqNDGhazHdbYttX8KUstre":{"type":"transition_id","content_hash":"J8GdrobxLDoBPDbkVWJ4jGbBAmyTfV2eE8H5DVhCr5QK","hash":"9nVmxFMpZdTWxusoztY2H8pHovDZLJbkfnHaS4TsFctL","fields":{"id":"e51dc45c-3b22-4552-980e-b96211caa1d3"}},"workflow_task_id:ETK7esNH2huZoyp7iBuGENGHobrr7Hb9oK68pPaUg7iq":{"type":"workflow_task_id","content_hash":"BRm6FW1rN4Z1qFtqXzeJb9Sb39JrgrdCmMypt4SebuHR","hash":"8nGfHsBC8QEgVXGaUtQxgCzwgHZAmfXzTP3Une3Jvk59","fields":{"id":"e84c8b5d1b3f4ff795a7ca4076c3d4d8"}},"workflow:5p1arLQczGUz1GSefthwrJV2ptzZZWPtTWswGhzEng2B":{"type":"workflow","content_hash":"DnvCggbqTEx6itXz3mRa52P9y53sznByP974nw7E6YLP","hash":"67cRf3Y68TJpdZ4ihKmWN52ijQqKKL33nFaH3dHDnpXN","fields":{"humanSecondsSaved":0,"notes":[],"output":[{"options":"{{ CTX.policyout}}"}],"parameters":{"userid":{"type":"string","required":true,"multiline":false}},"tasks":[{"id":"@@@workflow_task_id_ref1@@@","action":{"id":"@@@action_ref1@@@"},"humanSecondsSaved":0,"input":{},"isMocked":false,"join":1,"mockInput":{"mock_result":{}},"name":"core_noop","next":[{"do":[],"from":null,"id":"@@@transition_id_ref1@@@","publish":[{"key":"policyout","value":"{% if CTX.policy and CTX.policy | length != 0 %}\r\n{{- [\r\n    {\"id\": item.id, \"name\": item.policyname}\r\n    for item in CTX.policy\r\n] -}}\r\n{% else %}\r\n{{- [\r\n    {\"id\": 0, \"name\": \"No Matching Policy\"}\r\n] -}}\r\n{% endif %}\r\n"}],"to":null,"when":""}],"packOverrides":[],"publishResultAs":"","retry":null,"runAsOrgId":"","timeout":600,"transitionMode":"FOLLOW_FIRST","with":null},{"id":"@@@workflow_task_id_ref2@@@","action":{"id":"@@@action_ref1@@@"},"humanSecondsSaved":0,"input":{},"isMocked":false,"join":0,"mockInput":{"mock_result":{}},"name":"core_noop_1","next":[{"do":["@@@workflow_task_id_ref3@@@"],"from":null,"id":"@@@transition_id_ref2@@@","publish":[{"key":"cleaneduserid","value":"{{ (CTX.userid | from_json_string)['id'] }}"}],"to":null,"when":"{{ CTX.userid is string and CTX.userid | from_json_string is mapping and 'id' in (CTX.userid | from_json_string) and 'displayName' in (CTX.userid | from_json_string) }}\r\n"},{"do":["@@@workflow_task_id_ref3@@@"],"from":null,"id":"@@@transition_id_ref3@@@","publish":[{"key":"cleaneduserid","value":"{{CTX.userid}}"}],"to":null,"when":""}],"packOverrides":[],"publishResultAs":"","retry":null,"runAsOrgId":"","timeout":600,"transitionMode":"FOLLOW_FIRST","with":null},{"id":"@@@workflow_task_id_ref3@@@","action":{"id":"@@@action_ref2@@@"},"humanSecondsSaved":0,"input":{"json":null,"params":null,"headers":null,"base_url":"https://graph.microsoft.com/v1.0","endpoint":"/identity/conditionalAccess/policies","raw_body":null,"client_kwargs":{"use_delegated_admin":false},"request_method":"GET","raw_body_from_url":null,"require_2xx_status":null},"isMocked":false,"join":1,"mockInput":{"mock_result":{}},"name":"microsoft_graph_graph_api_request","next":[{"do":["@@@workflow_task_id_ref1@@@"],"from":null,"id":"@@@transition_id_ref4@@@","publish":[{"key":"policy","value":"{{ [{\"policyname\" : policy.displayName,\r\n        \"id\" : policy.id }\r\n    for policy in CTX.CAPolicies.data.value \r\n    if policy.conditions.locations \r\n    and \"All\" in policy.conditions.locations.includeLocations \r\n    and CTX.cleaneduserid not in policy.conditions.users.excludeUsers\r\n    ] }}"}],"to":null,"when":"{{ SUCCEEDED }}"}],"packOverrides":[],"publishResultAs":"CAPolicies","retry":null,"runAsOrgId":"","timeout":600,"transitionMode":"FOLLOW_ALL","with":null}],"timeout":28800,"type":"OPTION_GENERATOR","varsSchema":{}},"nonfunctional_fields":{"description":"","name":"PT - Get Conditional Access Policies","parameters.userid.description":"","parameters.userid.label":"","tasks[0].description":"Action that does nothing","tasks[0].metadata":{"x":706.0000000000001,"y":349.99783420596486},"tasks[0].next[0].label":"","tasks[1].description":"Action that does nothing","tasks[1].metadata":{"x":642.9412314914989,"y":-139.79596472962552},"tasks[1].next[0].label":"","tasks[1].next[1].label":"","tasks[2].description":"Send a request to any Microsoft Graph endpoint","tasks[2].metadata":{"x":712.2809917355373,"y":81.4360591444956},"tasks[2].next[0].label":""},"references":{"transition_id_ref1":{"kind":"string","type":"transition_id","src_key_hash":"A16HukKfDqQQcNq5qV3Hcd4PMmBPDZpJqksPd57vQoai","content_hash":"8eaGWFVsKkC89DmwwhMGuFxuP22DGPe7YPfHGDRtvdpA","locations":["tasks[0].next[0].id"]},"workflow_task_id_ref2":{"kind":"string","type":"workflow_task_id","src_key_hash":"ETK7esNH2huZoyp7iBuGENGHobrr7Hb9oK68pPaUg7iq","content_hash":"BRm6FW1rN4Z1qFtqXzeJb9Sb39JrgrdCmMypt4SebuHR","locations":["tasks[1].id"]},"transition_id_ref4":{"kind":"string","type":"transition_id","src_key_hash":"G37zscTRoJYvJC3hTvftQesqNDGhazHdbYttX8KUstre","content_hash":"J8GdrobxLDoBPDbkVWJ4jGbBAmyTfV2eE8H5DVhCr5QK","locations":["tasks[2].next[0].id"]},"transition_id_ref3":{"kind":"string","type":"transition_id","src_key_hash":"AXt5zo4oZuN6Ag7Uvshfgux2oEiVP9iSukjxzZFNo157","content_hash":"4M74ZoP8CBkkMoKDiML2oa5qSsFsnoQUorqjPZoXvqne","locations":["tasks[1].next[1].id"]},"transition_id_ref2":{"kind":"string","type":"transition_id","src_key_hash":"7fk3DrB3RHezgBShcBnFBaKkHK2on4nSv8hoe6TUbB3A","content_hash":"8YoRLo2qo2P4MkYbSuCLSdfHjyvfx6b2p6iCAfB7T5hF","locations":["tasks[1].next[0].id"]},"workflow_task_id_ref3":{"kind":"string","type":"workflow_task_id","src_key_hash":"DqEgKsVAo9aib2v3AWmLZE2xiXgyyjVPyFTi2Yzik36P","content_hash":"DYk5qaRdx2Ecp6uk6xTo5v7Eugah9Jc1apw8eCgTQG9g","locations":["tasks[2].id","tasks[1].next[0].do[0]","tasks[1].next[1].do[0]"]},"workflow_task_id_ref1":{"kind":"string","type":"workflow_task_id","src_key_hash":"H6xFYsZTd16V5YvtdhEV589pGebEq3FnbUK7YV8pVPQa","content_hash":"KhQ6pvasXj4T19pLbzfZqCH7WdzMH18DL2b9yp5M1Fz","locations":["tasks[0].id","tasks[2].next[0].do[0]"]},"action_ref2":{"kind":"string","type":"action","src_key_hash":"99LymnGHnd9HuxaqftaSrFV2ZBWr9yPCrB6vr2iVgVVe","content_hash":"23N3ubJaPa6X5iBRydHACFjBkPCx3ojoiFwyDcNZB5a1","locations":["tasks[2].action.id"]},"action_ref1":{"kind":"string","type":"action","src_key_hash":"88YPQyRQXBauPd9DrCvCqgLKwzGy6cvUyhum1Tr1ddd3","content_hash":"CdPL6KHuhM7mBvTHi4QnQbxCitnoxuRrq1BfHNnQYzKB","locations":["tasks[0].action.id","tasks[1].action.id"]}},"dependencies":["workflow_task_id:DqEgKsVAo9aib2v3AWmLZE2xiXgyyjVPyFTi2Yzik36P","action:88YPQyRQXBauPd9DrCvCqgLKwzGy6cvUyhum1Tr1ddd3","workflow_task_id:H6xFYsZTd16V5YvtdhEV589pGebEq3FnbUK7YV8pVPQa","transition_id:7fk3DrB3RHezgBShcBnFBaKkHK2on4nSv8hoe6TUbB3A","transition_id:A16HukKfDqQQcNq5qV3Hcd4PMmBPDZpJqksPd57vQoai","action:99LymnGHnd9HuxaqftaSrFV2ZBWr9yPCrB6vr2iVgVVe","transition_id:AXt5zo4oZuN6Ag7Uvshfgux2oEiVP9iSukjxzZFNo157","transition_id:G37zscTRoJYvJC3hTvftQesqNDGhazHdbYttX8KUstre","workflow_task_id:ETK7esNH2huZoyp7iBuGENGHobrr7Hb9oK68pPaUg7iq"]},"trigger:71r4b3SCFQ5F4AqEYKomr23gm3MKnbAUPA4jM1weThkV":{"type":"trigger","content_hash":"DUHS6px1wQB5Hp7bhNcaWSwy2qbxTj2eF4GAFsyHBD7q","hash":"9DhWYbui8HyCh5Xou6RmJyDyZ8Lq6V37QmdAXSTzZ63j","fields":{"autoActivateManagedOrgs":true,"criteria":{"condition":{}},"enabled":true,"formId":null,"isActivatedForOwner":true,"packOverrides":[],"parameters":{"secret_key":null,"response_body":"{{ REQUEST() | json_dump }}","allowed_methods":["POST"],"response_status":"200","include_raw_body":false,"response_headers":"{\"Content-Type\": \"application/json\"}","wait_for_results":false},"triggerTypeId":"@@@trigger_type_ref1@@@","vars":[],"workflowId":"@@@workflow_ref1@@@"},"nonfunctional_fields":{"description":null,"name":"Manual"},"references":{"workflow_ref1":{"kind":"string","type":"workflow","src_key_hash":"5p1arLQczGUz1GSefthwrJV2ptzZZWPtTWswGhzEng2B","content_hash":"DnvCggbqTEx6itXz3mRa52P9y53sznByP974nw7E6YLP","locations":["workflowId"]},"trigger_type_ref1":{"kind":"string","type":"trigger_type","src_key_hash":"826nxZe6xtC3TiBTjRMQxo1bm33qcCjTTPQZFTwVo3P6","content_hash":"HnoxQiJaD2AXzSixvrruvJbH2LA13kjSwUttGFc847xJ","locations":["triggerTypeId"]}},"dependencies":["trigger_type:826nxZe6xtC3TiBTjRMQxo1bm33qcCjTTPQZFTwVo3P6","workflow:5p1arLQczGUz1GSefthwrJV2ptzZZWPtTWswGhzEng2B"]},"trigger:C1tQPU9K9RC6ybeUhqcpMP8bqYzbWaVVNa2epvkDQUQC":{"type":"trigger","content_hash":"DxE32rYuTpxesnzo3y8RQDaMhjHNQdY3U9PWgWZb6qvY","hash":"FJvzvy4oTbw8vGwaBvkD2PM8Piw5Emc5BjPcARw1VgVn","fields":{"autoActivateManagedOrgs":true,"criteria":{"condition":{}},"enabled":true,"formId":null,"isActivatedForOwner":true,"packOverrides":[],"parameters":{},"triggerTypeId":"@@@trigger_type_ref1@@@","vars":[],"workflowId":"@@@workflow_ref1@@@"},"nonfunctional_fields":{"description":null,"name":"Alwayspass"},"references":{"trigger_type_ref1":{"kind":"string","type":"trigger_type","src_key_hash":"A8tNf5v7oR9dAqgjGczqVYzFssgg8bay7BL7uJeXcb8","content_hash":"A3qAuVRaMet6hmXzfULwNsktw3jhyuRkt8E9LAbJCP7i","locations":["triggerTypeId"]},"workflow_ref1":{"kind":"string","type":"workflow","src_key_hash":"5p1arLQczGUz1GSefthwrJV2ptzZZWPtTWswGhzEng2B","content_hash":"DnvCggbqTEx6itXz3mRa52P9y53sznByP974nw7E6YLP","locations":["workflowId"]}},"dependencies":["trigger_type:A8tNf5v7oR9dAqgjGczqVYzFssgg8bay7BL7uJeXcb8","workflow:5p1arLQczGUz1GSefthwrJV2ptzZZWPtTWswGhzEng2B"]}},"__typename":"ExportBundle"}